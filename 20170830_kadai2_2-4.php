      <?php$date=date("Y/m/d H:i");$name=$_POST['name'];$comment=$_POST['message'];$defaltname="NoName";$defaltcomment="Please write your any comment!";$edit=$_POST['editaction'];$editmode=0;if(isset($_POST['editaction'])){  $editmode=$_POST['2-5mode'];}if(isset($edit)){  $texts=file("kadai_2-2.txt");  foreach($texts as $line2){    $texts=explode("＜＞",$line2);    if($texts[0]==$_POST["editnumber"]){	$defaltname=$texts[1];	$defaltcomment=$texts[2];	$postnum =$texts[0];	$status="editok";    }  }}	$num = 1;	$array[] = $num."＜＞";	$array[] = htmlspecialchars($_POST["name"])."＜＞";	$array[] = htmlspecialchars($_POST["message"])."＜＞";	$array[] = date("Y/m/d H:i");if ( isset($_POST['action']) ){if($_SERVER["REQUEST_METHOD"]=="POST"){	if($_POST['2-5edit'] == "editok"){		$file=file("kadai_2-2.txt");		if($_SERVER["REQUEST_METHOD"]=="POST"){			$file=file("kadai_2-2.txt");			$fp=fopen("kadai_2-2.txt", "w");			for($i = 0; $i <count($file);$i++ ) {				$num = explode("＜＞",$file[$i]);				if($num[0]!= $_POST["2-5mode"]){					fwrite($fp,$file[$i]);				}else{					fwrite($fp,$num[0]."＜＞".$_POST['name']."＜＞".$_POST['message']."＜＞".$date);				}			}		}		fclose($fp);	}else{echo $_POST['2-5edit'];		//ファイルの中身を一行ずつ配列として取得		$line = file("kadai_2-2.txt");		//最終行の配列を取得		$finalline = $line[count($line)-1];		//最終行の配列を番号、名前、コメント、時刻.の4つの配列に分断		$endline = explode("＜＞",$finalline);		//番号の配列に+1する		$endline[0] += 1;		//配列arrayに最終投稿番号+1の値を代入		$array[0] = $endline[0]."＜＞";		//kadai_2-2に投稿内容を追加保存していく		$fp2 = fopen("kadai_2-2.txt","a");		//for文で配列arrayの要素をすべて書き込む		for($j=0; $j<count($array); $j++){			fwrite($fp2,$array[$j]);		}			fwrite($fp2,"\n");		fclose($fp2);	}}}	if ( isset($_POST['delaction']) ){		$filename="kadai_2-2.txt";	if($_SERVER["REQUEST_METHOD"]=="POST"){		$file=file($filename);		$fp=fopen($filename, "w");			for($i = 0; $i <count($file);$i++ ) {			$num = explode("＜＞",$file[$i]);				if($num[0]!= $_POST["delnumber"]){					fwrite($fp,$file[$i]);//!=　not equal入力された番号と一致しなかった時だけ上書き				}			}		}fclose($fp);}?>投稿用フォーム<form action ="20170830_kadai2_2-4.php" method ="post">	Name: <input type ="text" name ="name"  value="<?php echo $defaltname; ?>">	Comment: <input type ="text" name ="message" value="<?php echo $defaltcomment; ?>">	         <input type="hidden" name="2-5mode" value="<?php echo $postnum; ?>">         <input type="hidden" name="2-5edit" value="<?php echo $status; ?>">              	<button type ="submit" name="action" value="send">GO</button></form>削除用フォーム<form action ="20170830_kadai2_2-4.php" method ="post">	削除対象番号: <input type ="text" name ="delnumber">	<button type ="submit" name="delaction" value="delete">DELETE</button></form>編集用フォーム<form action ="20170830_kadai2_2-4.php" method ="post">	編集対象番号: <input type ="text" name ="editnumber">	<button type ="submit" name="editaction" value="edit">EDIT</button></form><?php$contents=file("kadai_2-2.txt");foreach($contents as $line){$message=explode("＜＞",$line);echo '<p>',$message[0],'</p>';echo '<p>',$message[1],'</p>';echo '<p>',$message[2],'</p>';echo '<p>',$message[3],'</p>';echo '<p>',$message[4],'</p>';}?>